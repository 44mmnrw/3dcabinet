# FreeCAD Макросы для DIN-рейки

В этом каталоге:
- `trim_to_length.FCMacro` — обрезает выбранный solid (например DIN-рейку) до целевой длины по самой длинной оси, сохраняя профиль.

## Быстрый старт
1. Откройте исходную модель рейки (600 мм) в FreeCAD.
2. Выделите объект (он должен содержать хотя бы один solid: PartDesign Body или Part::Feature).
3. Запустите макрос: `Macro > Execute... > trim_to_length.FCMacro`.
4. Введите целевую длину (например 450) и подтвердите.
5. Получите новый объект `<OldName>_Trimmed`. Исходный будет скрыт.

## Примечания
- Макрос не "растягивает" если вводимая длина больше текущей — вернёт копию пересечения (фактически исходный размер).
- Точность обрезки определяется точностью исходной геометрии; для профилей с фасками и отверстиями они сохраняются.
- Булевая операция может быть медленной на очень детализированных solids.

## Диагностика
- Если результат — параллелепипед, значит исходная модель была уже простой Box.
- Если появляется сообщение об ошибке булевой операции — проверьте целостность модели (Part → Check geometry).

## Расширения (идеи)
- Автоопределение ориентации рейки по нормали к наибольшей плоскости.
- Создание массива отверстий на концах после обрезки.
- Экспорт профиля в JSON (vertices + faces) для веб-визуализации.
